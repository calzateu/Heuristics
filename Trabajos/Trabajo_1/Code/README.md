The **main.py** file contains the implementation of the MainMethods class. This class is designed to solve a specific problem, the "Multi-trip Vehicle Routing Problem" (mtVRP). The class is responsible for reading data from files, computing distances between nodes, validating solutions, plotting routes, saving solutions to Excel files, running methods to solve the mtVRP, and running instances.

## Modules
- constructive
- constructive1
- constructive2
- GRASP
- GRASP2
- noise

## Method Definitions
- **__init__(self):** Constructor method to initialize the maximum number of nodes in the problem.

- **read_data(self, file_name):** Method to read and parse the input data from the given file. It returns problem information, nodes, and count.

- **compute_distances(self):** Method to compute the Euclidean distances between nodes.

- **__traveled_distance(self, path):** Method to compute the total distance traveled by a given path.

- **__validate_solutions(self, paths, method, print_validation):** Method to validate the solutions generated by the algorithm. It checks if the maximum capacity and maximum distance constraints are satisfied. It returns the total distance traveled by all the paths.

- **plot_routes(self, routes):** Method to plot the generated routes on a graph.

- **save_solution(self, instances, name):** Method to save the generated solutions in an Excel file.

- **run_method(self, method, verbose, print_validation):** Method to run the given algorithm on the input data. It returns the generated paths along with the total time taken by the algorithm and the total distance traveled by all the paths.

- **run_instances(self, Method, name, verbose, print_validation, \*\*kwargs):** Method to run the given algorithm on all the input data files in a given folder. It saves the generated solutions in an Excel file. It takes the algorithm class as input along with other optional arguments for the algorithm.

## Dependencies
- numpy
- matplotlib.pyplot
- openpyxl

To install them use the following command on your terminal inside of **Heuristics/Trabajos/Trabajo_1/Code/**:
```
pip install -r requirements.txt
```

## Usage
Import the MainMethods class from the module. Create an object of the MainMethods class. Call the **run_instances()** method to run the algorithm on all the input data files in a given folder and save the generated solutions in an Excel file.

```
from main import MainMethods
from GRASP import GRASP

mm = MainMethods()

mm.run_instances(Method=GRASP, name="GRASP_Results.xlsx", verbose=True, print_validation=False, max_iterations=100, k=2)
```

Or simply call the **run_method()** to test a single dataset.
```
import os

from main import MainMethods
from GRASP import GRASP

folder_path = "../mtVRP Instances"
folder_path = os.path.abspath(folder_path)
file = folder_path + '/mtVRP12.txt'
mm = MainMethods()

problem_information, nodes, cont = mm.read_data(file_name=file)
dist_matrix = mm.compute_distances()

verbose=True
graph=True

demands = nodes[:, 3].copy()
mm.run_method(method=GRASP(problem_information, dist_matrix, demands, max_iterations=100, k=2), verbose=verbose, graph=graph)
```
